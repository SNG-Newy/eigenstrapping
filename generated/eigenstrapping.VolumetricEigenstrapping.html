<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>eigenstrapping.VolumetricEigenstrapping &mdash; eigenstrapping 0.0.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
      <link rel="stylesheet" type="text/css" href="../_static/theme_overrides.css?v=ccc4b35e" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=c1dcd045"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="eigenstrapping.dataio.dataio" href="eigenstrapping.dataio.dataio.html" />
    <link rel="prev" title="eigenstrapping.SurfaceEigenstrapping" href="eigenstrapping.SurfaceEigenstrapping.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            eigenstrapping
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">Reference API</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../api.html#module-eigenstrapping"><code class="xref py py-mod docutils literal notranslate"><span class="pre">eigenstrapping</span></code> - Null models</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="eigenstrapping.SurfaceEigenstrapping.html">eigenstrapping.SurfaceEigenstrapping</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">eigenstrapping.VolumetricEigenstrapping</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#eigenstrapping.VolumetricEigenstrapping"><code class="docutils literal notranslate"><span class="pre">VolumetricEigenstrapping</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-eigenstrapping.dataio"><code class="xref py py-mod docutils literal notranslate"><span class="pre">eigenstrapping.dataio</span></code> - Data helpers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-eigenstrapping.datasets"><code class="xref py py-mod docutils literal notranslate"><span class="pre">eigenstrapping.datasets</span></code> - Dataset fetchers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-eigenstrapping.fit"><code class="xref py py-mod docutils literal notranslate"><span class="pre">eigenstrapping.fit</span></code> - Variogram fits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-eigenstrapping.geometry"><code class="xref py py-mod docutils literal notranslate"><span class="pre">eigenstrapping.geometry</span></code> - Mesh and eigenmode functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-eigenstrapping.plotting"><code class="xref py py-mod docutils literal notranslate"><span class="pre">eigenstrapping.plotting</span></code> - Plotting functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-eigenstrapping.rotations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">eigenstrapping.rotations</span></code> - Random rotation functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-eigenstrapping.stats"><code class="xref py py-mod docutils literal notranslate"><span class="pre">eigenstrapping.stats</span></code> - Statistical functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-eigenstrapping.utils"><code class="xref py py-mod docutils literal notranslate"><span class="pre">eigenstrapping.utils</span></code> - Utility functions</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">eigenstrapping</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api.html">Reference API</a></li>
      <li class="breadcrumb-item active">eigenstrapping.VolumetricEigenstrapping</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="eigenstrapping-volumetriceigenstrapping">
<h1>eigenstrapping.VolumetricEigenstrapping<a class="headerlink" href="#eigenstrapping-volumetriceigenstrapping" title="Permalink to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="eigenstrapping.VolumetricEigenstrapping">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">eigenstrapping.</span></span><span class="sig-name descname"><span class="pre">VolumetricEigenstrapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aseg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_modes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decomp_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'matrix'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eigenstrapping/base.html#VolumetricEigenstrapping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#eigenstrapping.VolumetricEigenstrapping" title="Permalink to this definition"></a></dt>
<dd><p>Compute the eigenmodes and eigenvalues of the volume in <cite>volume</cite> and
resample the hypersphere bounded by the eigengroups contained within <cite>emodes</cite>,
to reconstruct the data using coefficients conditioned on the original data
Based on the degenerate solutions of solving the Laplace-Beltrami operator
on the cortex. The power spectrum is perfectly retained (the square of the
eigenvalues). If evals and emodes are given (i.e., precomputed) then
eigenmodes are not computed. Performs amplitude adjustment by default (see
<cite>resample</cite>)</p>
<dl>
<dt>&#64;author: Nikitas C. Koussis, School of Psychological Sciences,</dt><dd><p>University of Newcastle &amp; Systems Neuroscience Group Newcastle</p>
<p>Michael Breakspear, School of Psychological Sciences,
University of Newcastle &amp; Systems Neuroscience Group Newcastle</p>
</dd>
</dl>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Several software packages must be installed apart from python dependencies
to use this class:</p>
<blockquote>
<div><ul class="simple">
<li><p>FreeSurfer &gt;5</p></li>
<li><p>Gmsh</p></li>
<li><p>fsl &gt;5 (if <code class="docutils literal notranslate"><span class="pre">aseg</span></code> not passed)</p></li>
</ul>
</div></blockquote>
</div>
<section id="process">
<h2>Process<a class="headerlink" href="#process" title="Permalink to this heading"></a></h2>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>the orthonormal eigenvectors n within eigengroup l give the surface</dt><dd><p>of the hyperellipse of dimensions l-1
NOTE: for eigengroup 0 with the zeroth mode, we ignore it,
and for eigengroup 1, this is resampling the surface of the
2-sphere</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>the axes of the hyperellipse are given by the sqrt of the eigenvalues</dt><dd><p>corresponding to eigenvectors n</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>linear transform the eigenvectors N to the hypersphere by dividing</dt><dd><p>by the ellipsoid axes</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>finds the set of points <cite>p</cite> on the hypersphere given by the basis</dt><dd><p>modes (the eigenmodes) by normalizing them to unit length</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>rotate the set of points <cite>p</cite> by cos(angle) for</dt><dd><p>even dimensions and sin(angle) for odd dims (resampling step)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>find the unit vectors of the points <cite>p</cite> by dividing by the</dt><dd><p>Euclidean norm (equivalent to the eigenmodes)</p>
</dd>
</dl>
</li>
<li><p>make the new unit vectors orthonormal using Gram-Schmidt process</p></li>
<li><dl class="simple">
<dt>return the new eigenmodes of that eigengroup until all eigengroups</dt><dd><p>are computed</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>reconstruct the null data by multiplying the original coefficients</dt><dd><p>by the new eigenmodes</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>resamples the null data by performing rank-ordering to replicate</dt><dd><p>the reconstructed data term, then adds the noise term back into the
null data to produce a surrogate that replicates the original
variance of the empirical data.
* Only performed if <cite>resample</cite> = True.</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p class="rubric">References</p>
<p>1. Robinson, P. A. et al., (2016), Eigenmodes of brain activity: Neural field
theory predictions and comparison with experiment. NeuroImage 142, 79-98.
&lt;<a class="reference external" href="https://dx.doi.org/10.1016/j.neuroimage.2016.04.050">https://dx.doi.org/10.1016/j.neuroimage.2016.04.050</a>&gt;</p>
<p>2. Jorgensen, M., (2014), Volumes of n-dimensional spheres and ellipsoids.
&lt;<a class="reference external" href="https://www.whitman.edu/documents/Academics/Mathematics/2014/jorgenmd.pdf">https://www.whitman.edu/documents/Academics/Mathematics/2014/jorgenmd.pdf</a>&gt;</p>
<ol class="arabic simple" start="3">
<li><p>&lt;<a class="reference external" href="https://math.stackexchange.com/questions/3316373/ellipsoid-in-n-dimension">https://math.stackexchange.com/questions/3316373/ellipsoid-in-n-dimension</a>&gt;</p></li>
</ol>
<p>4. Blumenson, L. E. (1960). A derivation of n-dimensional spherical
coordinates. The American Mathematical Monthly, 67(1), 63-66.
&lt;<a class="reference external" href="https://www.jstor.org/stable/2308932">https://www.jstor.org/stable/2308932</a>&gt;</p>
<p>5. Trefethen, Lloyd N., Bau, David III, (1997). Numerical linear algebra.
Philadelphia, PA: Society for Industrial and Applied Mathematics.
ISBN 978-0-898713-61-9.</p>
<ol class="arabic simple" start="6">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/QR_decomposition">https://en.wikipedia.org/wiki/QR_decomposition</a></p></li>
</ol>
<p>7. Chen, Y. C. et al., (2022). The individuality of shape asymmetries
of the human cerebral cortex. Elife, 11, e75056.
&lt;<a class="reference external" href="https://doi.org/10.7554/eLife.75056">https://doi.org/10.7554/eLife.75056</a>&gt;</p>
<dl class="field-list">
<dt class="field-odd">param volume<span class="colon">:</span></dt>
<dd class="field-odd"><p>Filename of volume ROI with integer intensity values. Must be in the same
space (i.e. registered) to the volume file in <cite>data</cite>. Extensions
are those commonly accepted by nibabel (see nibabel file types). Volume
is extracted using FreeSurfer or fslmaths if <code class="docutils literal notranslate"><span class="pre">aseg</span></code> is not passed.</p>
</dd>
<dt class="field-even">type volume<span class="colon">:</span></dt>
<dd class="field-even"><p>str to image</p>
</dd>
<dt class="field-odd">param data<span class="colon">:</span></dt>
<dd class="field-odd"><p>Filename of empirical data to resample</p>
</dd>
<dt class="field-even">type data<span class="colon">:</span></dt>
<dd class="field-even"><p>str to image or str to text file</p>
</dd>
<dt class="field-odd">param label<span class="colon">:</span></dt>
<dd class="field-odd"><p>Label of value in <code class="docutils literal notranslate"><span class="pre">volume</span></code> for ROI extraction. If default None, volume
is considered to be a mask - i.e., all values equal to 1 are extracted
and transformed to tetrahedral space, and those equal to 0 or otherwise
are left out. Default is None</p>
</dd>
<dt class="field-even">type label<span class="colon">:</span></dt>
<dd class="field-even"><p>int or list of ints or array of ints, optional</p>
</dd>
<dt class="field-odd">param aseg<span class="colon">:</span></dt>
<dd class="field-odd"><p>Specify whether file in <code class="docutils literal notranslate"><span class="pre">volume</span></code> is FreeSurfer preprocessed “aseg.mgz”
file. Extra steps need to be performed for computation, though labels
can be combined into structures (e.g., <code class="docutils literal notranslate"><span class="pre">label=[11,</span> <span class="pre">12,</span> <span class="pre">26]</span></code> with
<code class="docutils literal notranslate"><span class="pre">aseg=True</span></code> would combine the left caudate, left putamen, and left NA
to make the left striatum. See the FreeSurferColorLUT.txt for more
details about labeling). Default is False</p>
</dd>
<dt class="field-even">type aseg<span class="colon">:</span></dt>
<dd class="field-even"><p>bool, optional</p>
</dd>
<dt class="field-odd">param evals<span class="colon">:</span></dt>
<dd class="field-odd"><p>Eigenvalues corresponding to the number of eigenmodes n in <cite>emodes</cite>.
Default is None</p>
</dd>
<dt class="field-even">type evals<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray of shape (n,), optional</p>
</dd>
<dt class="field-odd">param emodes<span class="colon">:</span></dt>
<dd class="field-odd"><p>Eigenmodes that are the solution to the generalized eigenvalue problem
or Helmholtz equation in the Laplace-Beltrami operator of the volume
(must be in tetrahedral space). Default is None</p>
</dd>
<dt class="field-even">type emodes<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray of shape (n_vertices, n), optional</p>
</dd>
<dt class="field-odd">param num_modes<span class="colon">:</span></dt>
<dd class="field-odd"><p>If <cite>evals</cite> and <cite>emodes</cite> are not given, then they are computed on the
surface given in <cite>surface</cite>. This variable controls how many modes
to compute. Cannot exceed the number of vertices after tetrahedral
resampling of <code class="docutils literal notranslate"><span class="pre">volume</span></code>.
Default is 200.</p>
</dd>
<dt class="field-even">type num_modes<span class="colon">:</span></dt>
<dd class="field-even"><p>int, optional</p>
</dd>
<dt class="field-odd">param seed<span class="colon">:</span></dt>
<dd class="field-odd"><p>Specify the seed for random angle generation (or random state instance)
default None.</p>
</dd>
<dt class="field-even">type seed<span class="colon">:</span></dt>
<dd class="field-even"><p>None or int or np.random.RandomState instance</p>
</dd>
<dt class="field-odd">param decomp_method<span class="colon">:</span></dt>
<dd class="field-odd"><p>method of calculation of coefficients: ‘matrix’, ‘matrix_separate’,
‘regression’.</p>
<p>The default is ‘matrix’.</p>
</dd>
<dt class="field-even">type decomp_method<span class="colon">:</span></dt>
<dd class="field-even"><p>str, optional</p>
</dd>
<dt class="field-odd">param resample<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set whether to resample surrogate map from original map to preserve
values, default True</p>
</dd>
<dt class="field-even">type resample<span class="colon">:</span></dt>
<dd class="field-even"><p>bool, optional</p>
</dd>
<dt class="field-odd">param randomize<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set whether to shuffle coefficients calculated from minimizing
least-squares error to reconstruct surrogates. Results in better
randomization of surrogates at the cost of poorer replication of
empirical spatial autocorrelation.</p>
</dd>
<dt class="field-even">type randomize<span class="colon">:</span></dt>
<dd class="field-even"><p>bool, optional</p>
</dd>
<dt class="field-odd">param n_jobs<span class="colon">:</span></dt>
<dd class="field-odd"><p>Number of workers to use for parallelization. Default 1.</p>
</dd>
<dt class="field-even">type n_jobs<span class="colon">:</span></dt>
<dd class="field-even"><p>int, optional</p>
</dd>
<dt class="field-odd">param use_cholmod<span class="colon">:</span></dt>
<dd class="field-odd"><p>Specify whether or not to use sksparse subroutines - requires
<code class="docutils literal notranslate"><span class="pre">scikit-sparse</span></code> and <code class="docutils literal notranslate"><span class="pre">libsuitesparse-dev</span></code> to be installed. See
<a class="reference external" href="https://github.com/scikit-sparse/scikit-sparse">https://github.com/scikit-sparse/scikit-sparse</a> for more information.</p>
</dd>
<dt class="field-even">type use_cholmod<span class="colon">:</span></dt>
<dd class="field-even"><p>bool, optional</p>
</dd>
</dl>
<p>:raises ValueError : Inappropriate inputs:</p>
<dl class="py method">
<dt class="sig sig-object py" id="eigenstrapping.VolumetricEigenstrapping.calc_volume">
<span class="sig-name descname"><span class="pre">calc_volume</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nifti_volume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eigenstrapping/base.html#VolumetricEigenstrapping.calc_volume"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#eigenstrapping.VolumetricEigenstrapping.calc_volume" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the physical volume of the ROI in the nifti file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nifti_volume</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – Filename of input volume in nifti format</p></li>
<li><p><strong>label</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – Label value for input ROI in <code class="docutils literal notranslate"><span class="pre">nifti_volume</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>ROI_number</strong> (<em>int</em>) – Total number of non-zero voxels</p></li>
<li><p><strong>ROI_volume</strong> (<em>float</em>) – Total volume of non-zero voxels in physical dimensions</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eigenstrapping.VolumetricEigenstrapping.calc_volume_eigenmodes">
<span class="sig-name descname"><span class="pre">calc_volume_eigenmodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tetra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_modes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cholmod</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eigenstrapping/base.html#VolumetricEigenstrapping.calc_volume_eigenmodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#eigenstrapping.VolumetricEigenstrapping.calc_volume_eigenmodes" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the eigenvalues and eigenmodes of the ROI volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tetra</strong> (<em>lapy compatible object</em>) – Loaded lapy object corresponding to tetrahedral surface of ROI in vtk format</p></li>
<li><p><strong>num_modes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – Number of eigenmodes to compute. The default is 200</p></li>
<li><p><strong>use_cholmod</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Specify whether to use <code class="docutils literal notranslate"><span class="pre">scikit-sparse</span></code> libraries to compute eigenmodes.
Much faster but requires libraries to be installed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>evals</strong> (<em>np.ndarray of shape (num_modes,)</em>) – Eigenvalues</p></li>
<li><p><strong>emodes</strong> (<em>np.ndarray of shape (number of tetra points, num_modes)</em>) – Eigenmodes</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eigenstrapping.VolumetricEigenstrapping.calculate_distance_matrix">
<span class="sig-name descname"><span class="pre">calculate_distance_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eigenstrapping/base.html#VolumetricEigenstrapping.calculate_distance_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#eigenstrapping.VolumetricEigenstrapping.calculate_distance_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Calculates Euclidean distance matrix and index memmap files of ROI,
also returns data masked by ROI.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>outdir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – Output directory of distance and index np.memmap files.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>masked_data</strong> (<em>(N,)</em>)</p></li>
<li><p><strong>dist</strong> (<em>np.memmap</em>) – Distance memmap matrix.</p></li>
<li><p><strong>index</strong> (<em>str</em>) – Distance index memmap matrix</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eigenstrapping.VolumetricEigenstrapping.eigen_spectrum">
<span class="sig-name descname"><span class="pre">eigen_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eigenstrapping/base.html#VolumetricEigenstrapping.eigen_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#eigenstrapping.VolumetricEigenstrapping.eigen_spectrum" title="Permalink to this definition"></a></dt>
<dd><p>Plot the modal decomposition power spectrum. See <code class="docutils literal notranslate"><span class="pre">geometry.eigen_decomposition()</span></code>
Returns fig and ax handles from matplotlib.pyplot for further use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>show</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Flag whether to show plot, default True</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib.pyplot class</em>) – Figure handle</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.pyplot class</em>) – Axes handle</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eigenstrapping.VolumetricEigenstrapping.generate">
<span class="sig-name descname"><span class="pre">generate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_modes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eigenstrapping/base.html#VolumetricEigenstrapping.generate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#eigenstrapping.VolumetricEigenstrapping.generate" title="Permalink to this definition"></a></dt>
<dd><p>Generate eigensphere resampled surrogate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>output_modes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Output resampled modes for debugging. The default is False</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>(n,)</strong> – Surrogate data in tetrahedral space</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eigenstrapping.VolumetricEigenstrapping.make_tetra">
<span class="sig-name descname"><span class="pre">make_tetra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">volume</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aseg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eigenstrapping/base.html#VolumetricEigenstrapping.make_tetra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#eigenstrapping.VolumetricEigenstrapping.make_tetra" title="Permalink to this definition"></a></dt>
<dd><p>Generate tetrahedral version of the ROI in the nifti file. Can
specify label value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>volume</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Filename of input volume where the relevant ROI has voxel
values = 1 or <code class="docutils literal notranslate"><span class="pre">label</span></code></p></li>
<li><p><strong>label</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em> of </em><em>ints</em><em>, </em><em>optional</em>) – Label value(s) of input volume. Extracts surface from voxels that have
this(ese) intensity value(s). If None, defaults to 1</p></li>
<li><p><strong>aseg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Specify whether input volume and label is from FreeSurfer
aseg.nii.gz (post-FS preprocessing).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tetra_file</strong> – Filename of output tetrahedral vtk file</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.12)"><strong>RuntimeError</strong></a> – Multiple labels given but aseg not passed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eigenstrapping.VolumetricEigenstrapping.normalize_vtk">
<span class="sig-name descname"><span class="pre">normalize_vtk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tetra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eigenstrapping/base.html#VolumetricEigenstrapping.normalize_vtk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#eigenstrapping.VolumetricEigenstrapping.normalize_vtk" title="Permalink to this definition"></a></dt>
<dd><p>Normalize tetrahedral surface</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tetra</strong> (<em>lapy compatible object</em>) – Loaded vtk object corresponding to a surface tetrahedral mesh</p></li>
<li><p><strong>normalization_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em> or </em><em>None</em><em>, </em><em>optional</em>) – Type of normalization. The default is None.</p></li>
<li><p><strong>normalization_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em> or </em><em>None</em><em>, </em><em>optional</em>) – Factor to be used in “constant” normalization. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tetra_norm</strong> – Loaded vtk object corresponding to normalized tetrahedral surface</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>lapy compatible object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eigenstrapping.VolumetricEigenstrapping.project_to_tetra">
<span class="sig-name descname"><span class="pre">project_to_tetra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tetra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eigenstrapping/base.html#VolumetricEigenstrapping.project_to_tetra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#eigenstrapping.VolumetricEigenstrapping.project_to_tetra" title="Permalink to this definition"></a></dt>
<dd><p>Project data in volumetric space onto tetrahedral surface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tetra</strong> (<em>lapy compatible object</em>) – Loaded object corresponding to tetrahedral surface.</p></li>
<li><p><strong>data</strong> (<em>np.ndarray</em><em> of </em><em>shape</em><em> (</em><em>xx</em><em>, </em><em>yy</em><em>, </em><em>zz</em><em>)</em>) – Data to project to tetrahedral surface with values inside ROI.</p></li>
<li><p><strong>interpolation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – Interpolation kind. Default is ‘linear’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tetra_data</strong> – Resampled data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray of shape (number of tetra points,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eigenstrapping.VolumetricEigenstrapping.resample_data">
<span class="sig-name descname"><span class="pre">resample_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eigenstrapping/base.html#VolumetricEigenstrapping.resample_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#eigenstrapping.VolumetricEigenstrapping.resample_data" title="Permalink to this definition"></a></dt>
<dd><p>Resample data on tetrahedral surface to volumetric space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em><em> of </em><em>shape</em><em> (</em><em>n_tetra_points</em><em>, </em><em>N</em><em>)</em>) – Data to resample</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – Interpolation method for <code class="docutils literal notranslate"><span class="pre">scipy.interpolate.griddata</span></code>.
The default is ‘linear’.</p></li>
<li><p><strong>vector</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Resample data to masked vector (values inside ROI only). Default False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>resampled_data</strong> – Data in volumetric space.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray of shape (A,B,C,N)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eigenstrapping.VolumetricEigenstrapping.rotate_modes">
<span class="sig-name descname"><span class="pre">rotate_modes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">emodes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eigenstrapping/base.html#VolumetricEigenstrapping.rotate_modes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#eigenstrapping.VolumetricEigenstrapping.rotate_modes" title="Permalink to this definition"></a></dt>
<dd><p>Rotate modes using random rotations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vectors</strong> (<em>np.ndarray</em><em> of </em><em>(</em><em>n_vertices</em><em>, </em><em>mu</em><em>)</em>) – Orthogonal vectors of n_vertices and mu modes</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>rotated_vectors</strong> – Array containing rotated vectors for each pair.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray of (n_vertices, mu)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eigenstrapping.VolumetricEigenstrapping.surfplot">
<span class="sig-name descname"><span class="pre">surfplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">view</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dorsal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-4,</span> <span class="pre">4]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eigenstrapping/base.html#VolumetricEigenstrapping.surfplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#eigenstrapping.VolumetricEigenstrapping.surfplot" title="Permalink to this definition"></a></dt>
<dd><p>Plotting helper function for volumetric data to triangular
surfaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em><em> of </em><em>shape</em><em> (</em><em>n_vertices</em><em>,</em><em>)</em>) – Volumetric data projected to tetrahedral mesh. See self.project_to_tetra().</p></li>
<li><p><strong>view</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em> or </em><em>pair</em><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – Specify which direction to place camera and view from. See
<code class="docutils literal notranslate"><span class="pre">nilearn.plotting.plot_surf()</span></code> for accepted strings. If pair of
float, must be a list or tuple of (elevation, azimuthal) of angles
in degrees. The default is ‘dorsal’.</p></li>
<li><p><strong>cmap</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – Colormap for values in <code class="docutils literal notranslate"><span class="pre">data</span></code>. Must be in matplotlib colormaps.
The default is ‘viridis’</p></li>
<li><p><strong>vrange</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><em>tuple</em></a><em> of </em><em>two floats</em><em>, </em><em>optional</em>) – Range to truncate minimum and maximum values. The default is [-4, 4].</p></li>
<li><p><strong>annotations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Specify whether to add annotation labels for direction etc</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib.pyplot.Figure handle</em>)</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.pyplot.Axes handle</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

<div style='clear:both'></div></section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="eigenstrapping.SurfaceEigenstrapping.html" class="btn btn-neutral float-left" title="eigenstrapping.SurfaceEigenstrapping" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="eigenstrapping.dataio.dataio.html" class="btn btn-neutral float-right" title="eigenstrapping.dataio.dataio" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, eigenstrapping devs.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>